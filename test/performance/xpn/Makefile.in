

#
# Definitions
#

MAKE         		= make -s
CC           		= @CC@
MYHEADER     		= -I../../../include/ -I../../../include/base -I../../../include/xpn_client/ -I../../../include/bypass
MYLIBPATH    		= -L../../../src/base -L../../../src/xpn_client -L../../../src/bypass
LIBRARIES    		= -lxpn -lpthread -ldl -lmosquitto
MYFLAGS      		= -O3 -Wall -D_REENTRANT -DPOSIX_THREADS -DHAVE_CONFIG_H -D_GNU_SOURCE


#
# Rules
#

all:  open-write-close open-read-close create-dirs-test remove-dirs-test
open-write-close: open-write-close.o
	$(CC)  -o open-write-close open-write-close.o $(MYLIBPATH) $(LIBRARIES)

open-read-close: open-read-close.o
	$(CC)  -o open-read-close  open-read-close.o  $(MYLIBPATH) $(LIBRARIES)

create-dirs-test: create-dirs-test.o
	$(CC)  -o create-dirs-test  create-dirs-test.o  $(MYLIBPATH) $(LIBRARIES)

remove-dirs-test: remove-dirs-test.o
	$(CC)  -o remove-dirs-test  remove-dirs-test.o  $(MYLIBPATH) $(LIBRARIES)


%.o: %.c
	$(CC) $(CFLAGS)  $(MYFLAGS) $(MYHEADER) -c $< -o $@

clean:
	rm -f ./*.o
	rm -f ./open-write-close ./open-read-close ./create-dirs-test ./remove-dirs-test
